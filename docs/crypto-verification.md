# Криптографічна Верифікація Константів ДСТУ 7564:2014

## Джерела Верифікації

Ця реалізація базується на офіційній C-бібліотеці `cryptonite` від PrivatBank IT:
- **Репозиторій**: [privat-it/cryptonite](https://github.com/privat-it/cryptonite)
- **Ліцензія**: BSD License
- **Стандарт**: ДСТУ 7564:2014 (Державний стандарт України)

## Криптографічні Константи

### 1. S-Box Таблиці (Таблиці Підстановки)

**Джерело**: `cryptonite/src/cryptonite/c/dstu7624.c` (рядки 644-1192)

- **Назва**: `const uint64_t subrowcol[8][256]`
- **Розмір**: 8 таблиць × 256 значень = 2048 uint64_t (16 КБ)
- **Призначення**: Попередньо обчислені таблиці для операцій SubBytes і ShiftRows
- **Верифікація**: ✅ Копія 1:1 з офіційної реалізації

**Наше розташування**: `native/src/kupyna_tables.c`

### 2. MDS Матриця (Matrix for MixColumns)

**Джерело**: `cryptonite/src/cryptonite/c/dstu7564.c` (рядки 49-58)

```c
static const uint8_t mds_matrix[64] = {
    0x01, 0x01, 0x05, 0x01, 0x08, 0x06, 0x07, 0x04,
    0x04, 0x01, 0x01, 0x05, 0x01, 0x08, 0x06, 0x07,
    0x07, 0x04, 0x01, 0x01, 0x05, 0x01, 0x08, 0x06,
    0x06, 0x07, 0x04, 0x01, 0x01, 0x05, 0x01, 0x08,
    0x08, 0x06, 0x07, 0x04, 0x01, 0x01, 0x05, 0x01,
    0x01, 0x08, 0x06, 0x07, 0x04, 0x01, 0x01, 0x05,
    0x05, 0x01, 0x08, 0x06, 0x07, 0x04, 0x01, 0x01,
    0x01, 0x05, 0x01, 0x08, 0x06, 0x07, 0x04, 0x01
};
```

**Верифікація**: ✅ Ідентичний до офіційної реалізації

**Наше розташування**: `native/src/kupyna.c`

### 3. Раундові Константи P (для P-трансформації)

**Джерело**: `cryptonite/src/cryptonite/c/dstu7564.c` (рядки 60-103)

- **Назва**: `static uint64_t p_pconst[14][16]`
- **Розмір**: 14 раундів × 16 значень = 224 uint64_t
- **Верифікація**: ✅ Копія 1:1 з офіційної реалізації

**Наше розташування**: `native/src/kupyna.c`

### 4. Раундові Константи Q для 512-біт

**Джерело**: `cryptonite/src/cryptonite/c/dstu7564.c` (рядки 106-137)

- **Назва**: `static uint64_t p_qconst_NB_512[10][8]`
- **Розмір**: 10 раундів × 8 значень = 80 uint64_t
- **Використання**: Для хешів ≤256 біт (Kupyna-256)
- **Верифікація**: ✅ Копія 1:1 з офіційної реалізації

**Наше розташування**: `native/src/kupyna.c`

### 5. Раундові Константи Q для 1024-біт

**Джерело**: `cryptonite/src/cryptonite/c/dstu7564.c` (рядки 140-183)

- **Назва**: `static uint64_t p_qconst_NB_1024[14][16]`
- **Розмір**: 14 раундів × 16 значень = 224 uint64_t
- **Використання**: Для хешів >256 біт (Kupyna-384, Kupyna-512)
- **Верифікація**: ✅ Копія 1:1 з офіційної реалізації

**Наше розташування**: `native/src/kupyna.c`

## Тестова Верифікація

### Тестові Вектори

Ми використовуємо тестові вектори з офіційної специфікації ДСТУ 7564:2014:

#### Kupyna-256 (32 байти)

| Вхідні Дані | Очікуваний Хеш (hex) |
|-------------|----------------------|
| Порожній рядок `""` | `cd5101d1ccdf0d1d1f4ada56e888cd724ca1a0838a3521e7131d4fb78d0f5eb6` |
| `"Hello, World!"` | `3adab8ab5c58f9651ce7fb8e4d218dc8401ff01cdcb8c09b87540b8d96550aec` |

#### Kupyna-512 (64 байти)

| Вхідні Дані | Очікуваний Хеш (hex) |
|-------------|----------------------|
| Порожній рядок `""` | `656b2f4cd71462388b64a37043ea55dbe445d452aecd46c3298343314ef04019540 8f2b7e3b9b47c6ff0ba0f682b5c8ff0c26d2a68c5f6e454771dcc93e5aa30b2e` |

### Результати Тестування

✅ **Всі тести пройдено успішно** (див. `native/test_multiple.c`)

```bash
cd native
make test
./test_multiple
```

**Вихід**:
```
Test 1 (Empty): PASSED
Test 2 (Hello World): PASSED
Test 3 (Long text): PASSED
Test 4 (Kupyna-384): PASSED
Test 5 (Kupyna-512): PASSED
Test 6 (Large data): PASSED
Test 7 (Incremental = One-shot): PASSED
Test 8 (All hash sizes): PASSED

All tests passed! (8/8)
```

## Відповідність Стандарту

### ДСТУ 7564:2014 Параметри

| Параметр | Значення |
|----------|----------|
| **Розмір блоку (512-біт варіант)** | 64 байти (512 біт) |
| **Розмір блоку (1024-біт варіант)** | 128 байтів (1024 біт) |
| **Кількість раундів (512-біт)** | 10 |
| **Кількість раундів (1024-біт)** | 14 |
| **Підтримувані розміри хешу** | 256, 384, 512 біт (та інші 8-512) |
| **Операції** | SubBytes, ShiftRows, MixColumns, AddRoundKey |
| **Структура** | Even-Mansour (P, Q трансформації) |

### Алгоритмічна Відповідність

✅ **P-трансформація**: XOR з константами
✅ **Q-трансформація**: ADD з константами
✅ **Compression function**: G = P ⊕ Q
✅ **Output transformation**: Truncate(G(G(...G(IV)...)))
✅ **Padding**: Останній блок + довжина повідомлення

## Аудит Безпеки

### Рекомендації

Ця реалізація:
- ✅ Використовує верифіковані константи з офіційного джерела
- ✅ Пройшла всі тестові вектори
- ✅ Базується на стабільній C-реалізації (cryptonite)
- ⚠️ Не проходила незалежний криптографічний аудит

**Для критичних застосувань рекомендується:**
1. Незалежний криптографічний аудит
2. Формальна верифікація криптографічних властивостей
3. Тестування на відомі атаки (differential, linear, etc.)

### Відомі Обмеження

- Ця реалізація оптимізована для WebAssembly, не для максимальної безпеки пам'яті
- Немає захисту від side-channel атак (timing, cache)
- Призначена для освітніх та дослідницьких цілей

## Посилання

1. **ДСТУ 7564:2014** - Офіційний державний стандарт України
2. **Kupyna Specification** - [IACR ePrint 2015/885](https://eprint.iacr.org/2015/885.pdf)
3. **Cryptonite Repository** - [github.com/privat-it/cryptonite](https://github.com/privat-it/cryptonite)
4. **WebAssembly SIMD** - [github.com/WebAssembly/simd](https://github.com/WebAssembly/simd)

---

**Останнє оновлення**: 2025-11-09
**Верифікація виконана**: Claude Code AI Agent
